**********************************Revenue & Non-Revenue***************************************************************************************************
INSERT INTO REPORT_MASTER (REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
			VALUES('Revenue & Non-Revenue KMS',6,'OTHERS','Vehicle','Active','',12,null)

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(43,'truck','TRUCK','','select isNull(RegistrationNo,''NA'')as Truck, CASE when ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) <0 then 0 else ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) end as NonRevenueKMS from VehicleSummaryData vs where DateGMT between dateadd(mi,-?,?) and dateadd(mi,-?,?) and vs.SystemId=?  and vs.ClientId=? group by RegistrationNo')
			
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(43,'truckType','TRUCK TYPE','','select isNull(vm.VehicleType,'NA') as TruckType, sum(isNull(REVENUE_KMS,0)) as RevenueKMS,CASE when ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) <0 then 0 else ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) end as NonRevenueKMS from VehicleSummaryData vs left join tblVehicleMaster vm on vm.VehicleNo=vs.RegistrationNo where DateGMT between dateadd(mi,-330,'2018-05-01 00:00:00') and dateadd(mi,-330,'2018-05-25 23:59:59') and vs.SystemId=268  and vs.ClientId=5560 group by vm.VehicleType')				

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(43,'truckOEM','TRUCK OEM','','select isNull(mdl.ModelName,'NA') as TruckOEM, sum(isNull(REVENUE_KMS,0)) as RevenueKMS,CASE when ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) <0 then 0 else ((sum(isNull(TotalDistanceTravelled,0)) - sum(isNull(REVENUE_KMS,0)))) end as NonRevenueKMS from VehicleSummaryData vs left join tblVehicleMaster vm on vm.VehicleNo=vs.RegistrationNo left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModeltypeId=vm.Model and mdl.SystemId=vm.System_id where DateGMT between dateadd(mi,-330,'2018-05-01 00:00:00') and dateadd(mi,-330,'2018-05-25 23:59:59') and vs.SystemId=268  and vs.ClientId=5560 group by mdl.ModelName')				

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(43,'truckGroup','TRUCK GROUP','','select isNull(ag.GROUP_NAME,''NA'') as GroupName, isNull(tdt.Revenue,0) RevenueKMS, isNull((sum(TotalDistanceTravelled)- isNull(tdt.Revenue,0)),0) as NonRevenueKMS from VehicleSummaryData vs left outer join VEHICLE_CLIENT vc on vc.REGISTRATION_NUMBER=vs.RegistrationNo and vc.CLIENT_ID=vs.ClientId   left outer join ADMINISTRATOR.dbo.ASSET_GROUP ag on ag.GROUP_ID=vc.GROUP_ID left join(select GROUP_NAME,sum(ACTUAL_DISTANCE) as Revenue from TRACK_TRIP_DETAILS td left outer join VEHICLE_CLIENT vc on vc.REGISTRATION_NUMBER=td.ASSET_NUMBER and vc.CLIENT_ID=td.CUSTOMER_ID   left outer join ADMINISTRATOR.dbo.ASSET_GROUP ag on ag.GROUP_ID=vc.GROUP_ID where ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and td.SYSTEM_ID=?   and td.CUSTOMER_ID=? group by ag.GROUP_NAME) tdt on tdt.GROUP_NAME=ag.GROUP_NAME where DateGMT between dateadd(mi,-?,?) and dateadd(mi,-?,?) $ and SystemId=?  and ClientId=? group by ag.GROUP_NAME,Revenue')			

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('RevenueKMS', 'Revenue KMS', 'TRUE','Text')	
							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('NonRevenueKMS', 'NonRevenue KMS', 'TRUE','Text')	
							   	
*************************************Smart HUB % on time/delayed(For Touch points)***********************************************************************************************							   	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('hubName', 'HUB NAME', 'TRUE','Text')	

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('avgChangeOver', 'Average Change Over Time(HH:MM)', 'TRUE','Text')	

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(20,'tripId','TRIP ID','','select SHIPMENT_ID as TripId ,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0)  as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID where SEQUENCE >0 and SEQUENCE<100 and  ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by SHIPMENT_ID')
							   
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(20,'touchPoint','TOUCH POINT','','select lz.NAME as hubName,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and  ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by dtd.HUB_ID,lz.NAME')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(20,'routeName','ROUTE NAME','','select ttd.ROUTE_NAME as RouteName,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and  ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by ttd.ROUTE_NAME')

*************************************Average changeover time(For Smart Hubs)***********************************************************************************************					   
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(21,'tripId','TRIP ID','','select SHIPMENT_ID as TripId ,isnull(cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))/60 as varchar(10)) + '':'' +right(''00'' + cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))%60 as varchar(10)), 2),''0:00'') as avgChangeOver from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and  SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by SHIPMENT_ID')


INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(21,'smartHub','SMART HUB','','select lz.NAME as hubName ,isnull(cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))/60 as varchar(10)) + '':'' +right(''00'' + cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))%60 as varchar(10)), 2),''0:00'') as avgChangeOver from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by dtd.HUB_ID,lz.NAME')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(21,'routeName','ROUTE NAME','','select ttd.ROUTE_NAME as RouteName ,isnull(cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))/60 as varchar(10)) + '':'' +right(''00'' + cast(avg(DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME))%60 as varchar(10)), 2),''0:00'') as avgChangeOver from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and  ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by ttd.ROUTE_NAME')

*************************************% on time/delayed(For Smart Hubs)***********************************************************************************************					   

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(22,'tripId','TRIP ID','','select SHIPMENT_ID as TripId ,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0)  as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by SHIPMENT_ID')
							   
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(22,'smartHub','SMART HUB','','select lz.NAME as hubName,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and  SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by dtd.HUB_ID,lz.NAME')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(22,'routeName','ROUTE NAME','','select ttd.ROUTE_NAME as RouteName,isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 0 else 1 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as ontimeP, isnull(cast((sum(case when DATEDIFF(mi, ACT_ARR_DATETIME, ACT_DEP_DATETIME) > DETENTION_TIME then 1 else 0 END))*100/cast (COUNT(*) as float) as decimal(18,2)),0) as delayP from DES_TRIP_DETAILS dtd inner join TRACK_TRIP_DETAILS ttd on ttd.TRIP_ID=dtd.TRIP_ID left join LOCATION_ZONE_A lz on lz.HUBID=dtd.HUB_ID where SEQUENCE >0 and SEQUENCE<100 and  ACT_ARR_DATETIME IS NOT NULL and ACT_DEP_DATETIME IS NOT NULL and DETENTION_TIME IS NOT NULL and SYSTEM_ID=? and CUSTOMER_ID=? and ACT_ARR_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and ACT_DEP_DATETIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) and lz.OPERATION_ID=33 # group by ttd.ROUTE_NAME')

*************************************Incoming Vehicle Report**********************************************************************************************
INSERT INTO REPORT_MASTER (REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
			VALUES('Incoming Vehicle Report',6,'OTHERS','Hub','Active','',12,null)
			
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(47,'tripId','TRIP ID','','SELECT isnull(td.ORDER_ID,''NA'') as LRNO,td.SHIPMENT_ID TripId, tcd.NAME as Customer,td.ASSET_NUMBER as Truck,isnull(vm.VehicleType,''NA'') as TruckType,isnull(mdl.ModelName,''NA'') as TruckOEM,0 as distance,isnull(mdl.VehType,'''') as truckSize,isnull(dateadd(mi,?,td.DESTINATION_ETA),'''') as ETA,ROUTE_NAME as RouteName,isnull(AVG_SPEED,0) AS speed, gps.LONGITUDE as vehicleLng,gps.LATITUDE AS vehicleLat,lz.LONGITUDE as hubLng,lz.LATITUDE AS hubLat FROM dbo.gpsdata_history_latest gps INNER JOIN TRACK_TRIP_DETAILS td ON td.ASSET_NUMBER=gps.REGISTRATION_NO INNER JOIN DES_TRIP_DETAILS ds ON td.TRIP_ID=ds.TRIP_ID and ds.SEQUENCE=100 AND td.STATUS=''OPEN'' LEFT OUTER JOIN TRIP_CUSTOMER_DETAILS tcd ON tcd.ID=td.TRIP_CUSTOMER_ID LEFT OUTER JOIN LOCATION_ZONE_A lz ON lz.HUBID=ds.HUB_ID left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModeltypeId=vm.Model WHERE gps.LATITUDE IS NOT NULL AND gps.LONGITUDE IS NOT NULL AND lz.LATITUDE IS NOT NULL AND lz.LONGITUDE IS NOT NULL AND ACTUAL_TRIP_START_TIME IS NOT NULL #')

ALTER TABLE AMS.dbo.REPORT_MASTER ADD EXTRA_INPUT_FIELDS [varchar](50) NULL
			
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('truckSize', 'Container Size', 'TRUE','Text')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('distance', 'Distance(Km)', 'TRUE','Text')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('ETA', 'ETA', 'TRUE','Text')							   							   			
*************************************Loading/Unloading Detention Reports***********************************************************************************

INSERT INTO REPORT_MASTER (REPORT_ID,REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
			VALUES(51,'Average Loading/Unloading Detention',6,'OTHERS','Vehicle','Active','',21,null)


INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(51,'customer','CUSTOMER','','select isnull(td.CUSTOMER_NAME,''NA'') as Customer, isnull(avg(rb.LOADING_TIME),0) as LoadingDuration,isnull(avg(rb.UNLOADING_TIME),0) as unloadingTime  from REPORT_BUILDER_DETAILS rb left outer join TRACK_TRIP_DETAILS td on td.TRIP_ID=rb.TRIP_ID  where rb.SYSTEM_ID=? and rb.CUSTOMER_ID=?  and rb.TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) #  group by td.CUSTOMER_NAME order by td.CUSTOMER_NAME')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(51,'customerHub','CUSTOMER HUB','','select isnull(lz.NAME,''NA'') as CustomerHub,isnull(avg(rb.LOADING_TIME),0) as LoadingDuration,(select isnull(avg(rb1.UNLOADING_TIME),0) from REPORT_BUILDER_DETAILS rb1 INNER JOIN TRACK_TRIP_DETAILS td on td.TRIP_ID=rb1.TRIP_ID  INNER JOIN DES_TRIP_DETAILS des100 on des100.TRIP_ID=td.TRIP_ID AND des100.SEQUENCE=100 AND td.ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?)and des100.HUB_ID=des0.HUB_ID #) AS unloadingTime from REPORT_BUILDER_DETAILS rb INNER JOIN TRACK_TRIP_DETAILS td on td.TRIP_ID=rb.TRIP_ID  INNER JOIN DES_TRIP_DETAILS des0 on des0.TRIP_ID=td.TRIP_ID AND des0.SEQUENCE=0 LEFT OUTER JOIN LOCATION_ZONE_A lz ON lz.HUBID=des0.HUB_ID AND lz.OPERATION_ID=32 WHERE td.SYSTEM_ID=? AND td.CUSTOMER_ID=? AND td.ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by des0.HUB_ID,lz.NAME')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(51,'hubCity','HUB CITY','','select isnull(lz.HUB_CITY,''NA'') as hubCity,isnull(avg(rb.LOADING_TIME),0) as LoadingDuration,(select isnull(avg(rb1.UNLOADING_TIME),0) from REPORT_BUILDER_DETAILS rb1 INNER JOIN TRACK_TRIP_DETAILS td on td.TRIP_ID=rb1.TRIP_ID  INNER JOIN DES_TRIP_DETAILS des100 on des100.TRIP_ID=td.TRIP_ID AND des100.SEQUENCE=100 LEFT OUTER JOIN LOCATION_ZONE_A lz1 ON lz1.HUBID=des100.HUB_ID WHERE td.ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?)and lz1.HUB_CITY=lz.HUB_CITY #) AS unloadingTime from REPORT_BUILDER_DETAILS rb INNER JOIN TRACK_TRIP_DETAILS td on td.TRIP_ID=rb.TRIP_ID  INNER JOIN DES_TRIP_DETAILS des0 on des0.TRIP_ID=td.TRIP_ID AND des0.SEQUENCE=0 LEFT OUTER JOIN LOCATION_ZONE_A lz ON lz.HUBID=des0.HUB_ID WHERE td.SYSTEM_ID=? AND td.CUSTOMER_ID=? AND td.ACTUAL_TRIP_END_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by lz.HUB_CITY')

**************************************Unloading to next load*****************************************************************************			
INSERT INTO REPORT_MASTER (REPORT_ID,REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
					VALUES(54,'Unloading to Next load',6,'OTHERS','Vehicle','Active','',21,null)

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('unloadingToNextLoad', 'Unloading to next load(HH:MM)', 'TRUE','Text')	

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(54,'customerHub','CUSTOMER HUB','','SELECT isnull(lz.NAME,''NA'') as CustomerHub,isnull(vm.VehicleType,''NA'') as TruckType,SUM(CASE WHEN (DATEDIFF(mi,isnull(alert.GMT,dateadd(mi,lz.Standard_Duration,ACT_ARR_DATETIME)),t.NEXTSTP)) >0 THEN (DATEDIFF(mi,isnull(alert.GMT,dateadd(mi,lz.Standard_Duration,ACT_ARR_DATETIME)),t.NEXTSTP)) ELSE 0 END) as unloadingToNextLoad FROM TRACK_TRIP_DETAILS td LEFT OUTER JOIN DES_TRIP_DETAILS des100 ON td.TRIP_ID=des100.TRIP_ID AND des100.SEQUENCE=100 LEFT OUTER JOIN LOCATION_ZONE_A lz ON lz.HUBID=des100.HUB_ID left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModeltypeId=vm.Model outer apply( select TOP(1) desnext.PLANNED_ARR_DATETIME  AS NEXTSTP FROM TRACK_TRIP_DETAILS tdnext left outer join DES_TRIP_DETAILS desnext on  desnext.TRIP_ID=tdnext.TRIP_ID AND desnext.SEQUENCE=0 WHERE tdnext.ASSET_NUMBER=td.ASSET_NUMBER and desnext.PLANNED_ARR_DATETIME > des100.ACT_ARR_DATETIME  ORDER BY desnext.PLANNED_ARR_DATETIME) t outer apply((select top 1 t.GMT from (select GMT from Alert where REGISTRATION_NO=td.ASSET_NUMBER and HUB_ID=des100.HUB_ID and TYPE_OF_ALERT=38 and GMT between des100.ACT_ARR_DATETIME and des100.ACT_DEP_DATETIME union all select GMT from Alert_History where REGISTRATION_NO=td.ASSET_NUMBER and HUB_ID=des100.HUB_ID and TYPE_OF_ALERT=38 and GMT between  des100.ACT_ARR_DATETIME and des100.ACT_DEP_DATETIME)t)) alert where td.STATUS=''CLOSED'' AND td.SYSTEM_ID=? AND td.CUSTOMER_ID=? AND td.TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # AND NEXTSTP IS NOT NULL GROUP BY lz.NAME, vm.VehicleType')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(54,'hubCity','HUB CITY','','SELECT isnull(lz.HUB_CITY,''NA'') as hubCity,isnull(vm.VehicleType,''NA'') as TruckType,SUM(CASE WHEN (DATEDIFF(mi,isnull(alert.GMT,dateadd(mi,lz.Standard_Duration,ACT_ARR_DATETIME)),t.NEXTSTP)) >0 THEN (DATEDIFF(mi,isnull(alert.GMT,dateadd(mi,lz.Standard_Duration,ACT_ARR_DATETIME)),t.NEXTSTP)) ELSE 0 END) as unloadingToNextLoad FROM TRACK_TRIP_DETAILS td LEFT OUTER JOIN DES_TRIP_DETAILS des100 ON td.TRIP_ID=des100.TRIP_ID AND des100.SEQUENCE=100 LEFT OUTER JOIN LOCATION_ZONE_A lz ON lz.HUBID=des100.HUB_ID left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModeltypeId=vm.Model outer apply( select TOP(1) desnext.PLANNED_ARR_DATETIME  AS NEXTSTP FROM TRACK_TRIP_DETAILS tdnext left outer join DES_TRIP_DETAILS desnext on  desnext.TRIP_ID=tdnext.TRIP_ID AND desnext.SEQUENCE=0 WHERE tdnext.ASSET_NUMBER=td.ASSET_NUMBER and desnext.PLANNED_ARR_DATETIME > des100.ACT_ARR_DATETIME  ORDER BY desnext.PLANNED_ARR_DATETIME) t outer apply((select top 1 t.GMT from (select GMT from Alert where REGISTRATION_NO=td.ASSET_NUMBER and HUB_ID=des100.HUB_ID and TYPE_OF_ALERT=38 and GMT between des100.ACT_ARR_DATETIME and des100.ACT_DEP_DATETIME union all select GMT from Alert_History where REGISTRATION_NO=td.ASSET_NUMBER and HUB_ID=des100.HUB_ID and TYPE_OF_ALERT=38 and GMT between  des100.ACT_ARR_DATETIME and des100.ACT_DEP_DATETIME)t)) alert where td.STATUS=''CLOSED'' AND td.SYSTEM_ID=? AND td.CUSTOMER_ID=? AND td.TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # AND NEXTSTP IS NOT NULL group by lz.HUB_CITY, vm.VehicleType')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('hubCity', 'HUB CITY', 'TRUE','Text')	

***********************************************Utilization Report********************************************************************
INSERT INTO REPORT_MASTER (REPORT_ID,REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
					VALUES(55,'Utilization Report',6,'OTHERS','Vehicle','Active','',22,null)
					
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(55,'truckType','TRUCK TYPE','','select isnull(vm.VehicleType,''NA'') as TruckType, cast(isnull(sum(ACTUAL_DISTANCE),0)as decimal(18,2)) as kmsTravelled from TRACK_TRIP_DETAILS td left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModeltypeId=vm.Model where td.SYSTEM_ID=? AND td.CUSTOMER_ID=? AND td.TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) AND (TRIP_CATEGORY IS NULL OR TRIP_CATEGORY <>''Empty Trip'') # group by vm.VehicleType')
					

*************************************Unloading Detention***********************************************************************
INSERT INTO REPORT_MASTER (REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
					VALUES('Unloading Detention',6,'OTHERS','Vehicle','Active','',23,null)
					
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(56,'truckType','TRUCK TYPE','','(select r.customername as Customer,r.VehicleType as TruckType,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME,isnull(vm.VehicleType,''NA'') as VehicleType  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER  where td.SYSTEM_ID=?  and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,vm.VehicleType,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)<=480  group by r.customername,r.VehicleType)  union all   (select r.customername as Customer,r.VehicleType as TruckType,'' as ''0to8_Hours'',count(truck) as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(vm.VehicleType,''NA'') as VehicleType,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER  where td.SYSTEM_ID=?  and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,vm.VehicleType,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 480 and 960  group by r.customername,r.VehicleType)  union all  (select r.customername as Customer,r.VehicleType as TruckType,'' as ''0to8_Hours'','' as ''8to16_Hours'',count(truck) as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(vm.VehicleType,''NA'') as VehicleType,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,vm.VehicleType,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 960 and 1440  group by r.customername,r.VehicleType)  union all  (select r.customername as Customer,r.VehicleType as TruckType,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'',count(truck) as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(vm.VehicleType,''NA'') as VehicleType,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,vm.VehicleType,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between  1440 and 2440  group by r.customername,r.VehicleType)  union all  (select r.customername as Customer,r.VehicleType as TruckType,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  count(truck) as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(vm.VehicleType,''NA'') as VehicleType,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  left outer join tblVehicleMaster vm on vm.VehicleNo=td.ASSET_NUMBER  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME,vm.VehicleType ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)>2440  group by r.customername,r.VehicleType)  order by Customer')
					
INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(56,'customer','CUSTOMER','','(select r.customername as Customer,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)<=480  group by r.customername)  union all   (select r.customername as Customer,'' as ''0to8_Hours'',count(truck) as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 480 and 960  group by r.customername)  union all  (select r.customername as Customer,'' as ''0to8_Hours'','' as ''8to16_Hours'',count(truck) as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 960 and 1440  group by r.customername)  union all  (select r.customername as Customer,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'',count(truck) as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between  1440 and 2440  group by r.customername)  union all  (select r.customername as Customer,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  count(truck) as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)>2440  group by r.customername)  order by Customer ')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(56,'customerHub','CUSTOMER HUB','','(select r.customername as Customer,r.NAME as CustomerHub,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(lz.NAME,''NA'') as NAME,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,lz.NAME,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)<=480  group by r.customername,NAME)  union all   (select r.customername as Customer,r.NAME as CustomerHub,'' as ''0to8_Hours'',count(truck) as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(lz.NAME,''NA'') as NAME,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,lz.NAME,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 480 and 960  group by r.customername,NAME)  union all  (select r.customername as Customer,r.NAME as CustomerHub,'' as ''0to8_Hours'','' as ''8to16_Hours'',count(truck) as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(lz.NAME,''NA'') as NAME,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,lz.NAME,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 960 and 1440  group by r.customername,NAME)  union all  (select r.customername as Customer,r.NAME as CustomerHub,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'',count(truck) as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(lz.NAME,''NA'') as NAME,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,lz.NAME,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between  1440 and 2440  group by r.customername,NAME)  union all  (select r.customername as Customer,r.NAME as CustomerHub,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  count(truck) as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(lz.NAME,''NA'') as NAME,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,lz.NAME,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)>2440  group by r.customername,NAME)  order by Customer,CustomerHub')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(56,'city','CITY','','(select r.customername as Customer,r.HUB_CITY as hubCity,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)<=480  group by r.customername,HUB_CITY)  union all   (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'',count(truck) as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 480 and 960  group by r.customername,HUB_CITY)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'','' as ''8to16_Hours'',count(truck) as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 960 and 1440  group by r.customername,HUB_CITY)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'',count(truck) as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between  1440 and 2440  group by r.customername,HUB_CITY)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,count(truck) as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  count(truck) as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)>2440  group by r.customername,HUB_CITY)  order by Customer,hubCity')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
		VALUES(56,'truck','TRUCK','','(select r.customername as Customer,r.HUB_CITY as hubCity,truck as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,isnull(HUB_CITY,''NA'') as HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME)<=480)  union all   (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'',truck as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 480 and 960)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'','' as ''8to16_Hours'',truck as ''16to24_Hours'','' as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 960 and 1440)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'',truck as ''24to48_Hours'',  '' as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) between 1440 and 2880)  union all  (select r.customername as Customer,r.HUB_CITY as hubCity,'' as ''0to8_Hours'','' as ''8to16_Hours'','' as ''16to24_Hours'','' as ''24to48_Hours'',  truck as grt48_Hours from   (select tc.NAME as customername,td.ASSET_NUMBER as truck,HUB_CITY,  sum(datediff(mi,ACT_DEP_DATETIME,ACT_ARR_DATETIME)) as TRIPUNLOADTIME  from dbo.REPORT_BUILDER_DETAILS a  inner join TRACK_TRIP_DETAILS td on td.TRIP_ID=a.TRIP_ID  inner join DES_TRIP_DETAILS des on des.TRIP_ID=a.TRIP_ID and des.SEQUENCE=100  left outer join LOCATION_ZONE_A lz on lz.HUBID=des.HUB_ID  left outer join TRIP_CUSTOMER_DETAILS tc on tc.ID=td.TRIP_CUSTOMER_ID  where td.SYSTEM_ID=? and td.CUSTOMER_ID=? and td.ACTUAL_TRIP_START_TIME between dateadd(mi,-?,?) and dateadd(mi,-?,?) # and   td.STATUS=''CLOSED'' group by tc.NAME ,HUB_CITY,td.ASSET_NUMBER)r where (TRIPUNLOADTIME) >2880)  order by Customer,hubCity ')

					
select  isnull(ORDER_ID,'' '') as TripId,isnull(td.ASSET_NUMBER,'' '') as Truck,   td.PRODUCT_LINE as tripType,isnull(td.TRIP_CATEGORY,'' '')as TripCategory,isnull(trd.ROUTE_KEY,'' '') as RouteKey,td.ROUTE_NAME as RouteName,      isnull(ds1.NAME,'' '') as origin, isnull(ds.NAME,'' '') as destination, isnull(td.CUSTOMER_NAME,'' '') as Customer ,  isnull(left(trd.ROUTE_KEY,len(trd.ROUTE_KEY)-CHARINDEX(''_'', trd.ROUTE_KEY)),'''') as OriginCity ,isnull(right(trd.ROUTE_KEY,len(trd.ROUTE_KEY)-CHARINDEX(''_'', trd.ROUTE_KEY)),'''') as DestinationCity,      isnull(dateadd(mi,$,ds1.PLANNED_ARR_DATETIME),'' '') as originSTP,     isnull(dateadd(mi,$,ds1.ACT_ARR_DATETIME),'' '') as originATP, DATEDIFF(mi,ISNULL(ds1.PLANNED_ARR_DATETIME,getutcdate()),isnull(ds1.ACT_ARR_DATETIME,getutcdate()))  as delayedPlacementATP_STP,   isnull(dateadd(mi,$,td.TRIP_START_TIME),'''') as origin_STD,   isnull(dateadd(mi,$,td.ACTUAL_TRIP_START_TIME),'' '') as origin_ATD,   DATEDIFF(mi,isnull(td.TRIP_START_TIME,getutcdate()),ISNULL(td.ACTUAL_TRIP_START_TIME,getutcdate()))  as delayedDepartureATD_STD,  td.PLANNED_DURATION as transitTimeHrs,   isnull(dateadd(mi,( $ + isnull(td.PLANNED_DURATION,0)),td.ACTUAL_TRIP_START_TIME),'' '') as destinationETA,   isnull(dateadd(mi,$,ds.ACT_ARR_DATETIME),'' '') as ATADate,   isnull(dateadd(mi,$,ds.ACT_ARR_DATETIME),'' '') as destinationATA,   DATEDIFF(mi,ISNULL(ds.ACT_ARR_DATETIME,getutcdate()),isnull(ds.ACT_DEP_DATETIME,getutcdate())) as unloadingDetention,   DATEDIFF(mi,ISNULL(td.ACTUAL_TRIP_START_TIME,getutcdate()),isnull(ds.ACT_ARR_DATETIME,td.ACTUAL_TRIP_END_TIME))  as actualTT,   DATEDIFF(mi,isnull(dateadd(mi,($+ isnull(td.PLANNED_DURATION,0)),td.ACTUAL_TRIP_START_TIME),getutcdate()),isnull(dateadd(mi,$,ds.ACT_ARR_DATETIME),getutcdate()))  as delayHrs,  td.STOPPAGE_DURATION as stoppageDuration,    isnull(td.ACTUAL_DISTANCE,0) as totalDistanceTravelled,isnull(td.AVG_SPEED,0) as averageSpeed ,    isnull((select dhl.REMARKS from AMS.dbo.TRIP_REMARKS_DETAILS dhl where dhl.TRIP_ID=td.TRIP_ID and INSERTED_DATETIME=(select max(INSERTED_DATETIME) from AMS.dbo.TRIP_REMARKS_DETAILS where dhl.TRIP_ID=td.TRIP_ID) ),'' '')as Remarks,    isnull((select dhl.REASON from AMS.dbo.TRIP_REMARKS_DETAILS dhl where dhl.TRIP_ID=td.TRIP_ID and INSERTED_DATETIME=(select max(INSERTED_DATETIME) from AMS.dbo.TRIP_REMARKS_DETAILS where dhl.TRIP_ID=td.TRIP_ID) ),'' '')as Reason     from AMS.dbo.TRACK_TRIP_DETAILS td      left outer join AMS.dbo.DES_TRIP_DETAILS ds on ds.TRIP_ID=td.TRIP_ID and ds.SEQUENCE=100      left outer join AMS.dbo.DES_TRIP_DETAILS ds1 on ds1.TRIP_ID=td.TRIP_ID and ds1.SEQUENCE=0     left outer join AMS.dbo.LOCATION_ZONE_A slz on slz.HUBID=ds1.HUB_ID  left outer join AMS.dbo.LOCATION_ZONE_A dlz on   dlz.HUBID=ds.HUB_ID  left outer join AMS.dbo.gpsdata_history_latest gps on gps.REGISTRATION_NO=td.ASSET_NUMBER and   gps.System_id=td.SYSTEM_ID left outer join AMS.dbo.TRIP_ROUTE_MASTER trd on trd.ID=td.ROUTE_ID    where td.STATUS = ''CLOSED'' and td.SYSTEM_ID = ? and td.CUSTOMER_ID = ?      and td.ACTUAL_TRIP_END_TIME between dateadd(mi,-$,?) and dateadd(mi,-$,?) # 						   

*****************************************Kms Run by Vehicle Number*********************************************************************
INSERT INTO REPORT_MASTER (REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE,REPORT_INFO)
			VALUES('KM RUN REPORT',6,'OTHERS','Vehicle','Active','',24,null,'<b>Ops Dry Run</b> - kms travelled by a vehicle from ATA to the time a new trip is created in the system for the same vehicle<br><b>Customer Dry Run</b> - kms travelled by a vehicle from the time a trip is created for it in the system till the actual time of placement <br><b>Customer Billed/Trip Run</b> - kms travelled from ATD to ATA')

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(57,'truck','TRUCK','','SELECT ASSET_NUMBER as Truck,isnull(vm.VehicleType,''NA'') as TruckType,isnull(SUM(OPS_DRYRUN_KMS),0) AS opsDryRun,cast(ISNULL(SUM(OPS_DRYRUN_KMS),0) * 100 /cast (SUM(TOTAL_RUN) as float) as decimal(18,2)) as opsDryRunPercent,ISNULL(SUM(CUSTOMER_DRYRUN),0) AS customerDryRun,cast(SUM(CUSTOMER_DRYRUN) * 100 /cast (SUM(TOTAL_RUN) as float) as decimal(18,2)) as customerDryRunPercent,SUM(DISTANCE_TRAVELLED) AS customerBilledRun,cast(SUM(DISTANCE_TRAVELLED) * 100 /cast (SUM(TOTAL_RUN) as float) as decimal(18,2)) as customerBilledRunPercent,SUM(TOTAL_RUN) AS totalRun FROM REPORT_BUILDER_DETAILS rb left outer join tblVehicleMaster vm on vm.VehicleNo=rb.ASSET_NUMBER WHERE rb.SYSTEM_ID=? and rb.CUSTOMER_ID=?   and rb.TRIP_END_TIME between dateadd(mi,-?,?)   and dateadd(mi,-?,?) # group by ASSET_NUMBER,vm.VehicleType')

			
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('opsDryRun', 'OPS DRY RUN(KMS)', 'TRUE','Text')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('opsDryRunPercent', 'OPS DRY RUN(%)', 'TRUE','Text')
							   							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('customerDryRun', 'CUSTOMER DRY RUN(KMS)', 'TRUE','Text')
							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('customerDryRunPercent', 'CUSTOMER DRY RUN(%)', 'TRUE','Text')
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('locationAtTripClosure', 'Location at trip closure', 'TRUE','Text')
							   							   

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('customerBilledRun', 'CUSTOMER BILLED RUN(KMS)', 'TRUE','Text')							   							   

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('customerBilledRunPercent', 'CUSTOMER BILLED RUN(%)', 'TRUE','Text')
	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('totalRun', 'TOTAL RUN(KMS)', 'TRUE','Text')							   							   

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('locationAtTripCreation', 'Location at trip creation', 'TRUE','Text')
							   
							   							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('lastTripNum', 'Last Trip No.', 'TRUE','Text')	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('lastTripId', 'Last Trip ID.', 'TRUE','Text')	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('lastTripCustName', 'Last Trip Customer name', 'TRUE','Text')								   							   	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('lastTripEndTime', 'Last Trip End Time', 'TRUE','DateTime')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('newTripNum', 'New Trip No.', 'TRUE','Text')	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('newTripId', 'New Trip ID.', 'TRUE','Text')	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('newTripCustName', 'New Trip Customer name', 'TRUE','Text')								   							   	
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('newTripStartTime', 'New Trip Creation Time', 'TRUE','DateTime')							   
							   							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('newTripId', 'New Trip No.', 'TRUE','Text')

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('atp', 'ATP', 'TRUE','DateTime')							   								   	


INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('stp', 'STP', 'TRUE','DateTime')	
							   
SELECT TRUCK,SUM(OPS_DRYRUN_KMS) AS opsDryRun,SUM(CUSTOMER_DRYRUN) AS customerDryRun,SUM(CUSTOMER_BILLED_RUN) AS customerBilledRun
(SUM(OPS_DRYRUN_KMS)+SUM(CUSTOMER_DRYRUN)+SUM(CUSTOMER_BILLED_RUN)) AS totalRun
FROM REPORT_BUILDER_DETAILS group by ASSET_NUMBER


ALTER TABLE AMS.dbo.REPORT_MASTER ADD REPORT_INFO [varchar](500) NULL

ALTER TABLE AMS.dbo.TRACK_TRIP_DETAILS ADD ATP_DELAY_ACKNOWLEDGE [varchar](500) NULL


ALTER TABLE ON_TRIP_VEHICLE_STOPPAGE_ACTION ADD STOPPAGE_START_TIME [datetime] NULL

ALTER TABLE AMS.dbo.TRACK_TRIP_DETAILS ADD ACKNOWLEDGED_DATE [datetime] NULL

ALTER TABLE AMS.dbo.TRACK_TRIP_DETAILS ADD ACKNOWLEDGED_BY [int] NULL



select RegistrationNo as Truck,sum(TotalDistanceTravelled) as kmsTravelled from VehicleSummaryData 
where SystemId=? and ClientId= ? and DateGMT between dateadd(mi,-?,?) and dateadd(mi,-?,?) # group by RegistrationNo 

select isnull(mdl.ModelName,'NA') as TruckOEM,sum(TotalDistanceTravelled) as kmsTravelled from 
VehicleSummaryData vs left outer join tblVehicleMaster vm on vm.VehicleNo=vs.RegistrationNo 
left outer join FMS.dbo.Vehicle_Model mdl on mdl.ModelTypeId=vm.Model where vs.SystemId=? and vs.ClientId= ? and 
DateGMT between dateadd(mi,-?,?) and dateadd(mi,-?,?) #  group by mdl.ModelName

=======================================ACKNOWLEDGEMENT HISTORY===========================================================

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('acknowledgement', 'ACKNOWLEDGEMENT', 'TRUE','Text')	

INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('acknowledgedDate', 'ACKNOWLEDGED DATE', 'TRUE','DateTime')
							   
INSERT INTO dbo.REPORT_COLUMN_MASTER (PARAMETER,COLUMN_NAME,FILTER,FILTER_TYPE)
							   VALUES('acknowledgedBy', 'ACKNOWLEDGED BY', 'TRUE','Text')		
							   
INSERT INTO REPORT_MASTER (REPORT_NAME,CATEGORY_ID,CATEGORY_NAME,SELECTION_TYPE,STATUS,IS_CUSTOMER,DISPLAY_ORDER,SINGLE_OR_MULTIPLE)
			VALUES('Alert history of Trip Delay',6,'OTHERS','Vehicle','Active','',25,null)

INSERT INTO dbo.REPORT_PARAMETERS (REPORT_ID,PARAMETER_ID,PARAMETER_ALIAS,VISIBILITY,SQL_QUERY)
			VALUES(58,'tripNo','TRIP NUMBER','','SELECT isnull(td.ORDER_ID,''NA'') as LRNO,td.ASSET_NUMBER as Truck,td.ROUTE_NAME as RouteName, ATP_DELAY_ACKNOWLEDGE as acknowledgement,ACKNOWLEDGED_DATE as acknowledgedDate,u.Firstname+' '+u.Lastname as acknowledgedBy FROM TRACK_TRIP_DETAILS td left outer join Users u on u.User_id=td.ACKNOWLEDGED_BY where ATP_DELAY_ACKNOWLEDGE is not null AND ACKNOWLEDGED_DATE BETWEEN between dateadd(mi,-?,?) and dateadd(mi,-?,?)')
							   
							   






