package t4u.statements;

public class SelfDriveCarsStatements {

	public static final String GET_HARSH_COUNTS = "SELECT COUNT(DISTINCT(ha.REGISTRATION_NO)) AS DISTINCTCOUNT, COUNT(TYPE_OF_ALERT) AS ALERTCOUNT  ,TYPE_OF_ALERT FROM ALERT.dbo.HARSH_ALERT_DATA ha"
		+ " INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT "
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO   = ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=ha.SYSTEM_ID and lvs.CLIENT_ID=ha.CUSTOMER_ID  "
		+ " WHERE ha.SYSTEM_ID = ? AND ha.CUSTOMER_ID = ? AND ha.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? # GROUP BY TYPE_OF_ALERT  UNION "
		+ " SELECT COUNT(DISTINCT(hah.REGISTRATION_NO)) AS DISTINCTCOUNT, COUNT(TYPE_OF_ALERT) AS ALERTCOUNT  ,TYPE_OF_ALERT FROM ALERT.dbo.HARSH_ALERT_DATA_HISTORY hah  " 
		+ " INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hah.REGISTRATION_NO COLLATE DATABASE_DEFAULT  " 
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO  = hah.REGISTRATION_NO COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=hah.SYSTEM_ID and lvs.CLIENT_ID=hah.CUSTOMER_ID "
		+ " WHERE hah.SYSTEM_ID = ? AND hah.CUSTOMER_ID = ?  AND hah.GMT BETWEEN DATEADD(mi,-?,?) AND DATEADD(mi,-?,?) AND vu.User_id = ? # GROUP BY TYPE_OF_ALERT ";

	public static final String GET_HARSH_DATA = "SELECT a.REGISTRATION_NO AS 'VEHICLE NUMBER',a.GROUP_NAME AS 'GROUP NAME' , DATEADD (MI,?,a.GMT) AS 'ALERT TIME' , a.LOCATION, a.TRIP_ID AS 'TRIP ID',a.RATE_OF_CHANGE_SPEED AS DEACCELERATION FROM("
		+ " SELECT s.TRIP_ID, ha.REGISTRATION_NO,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME,ha.GMT,ha.LOCATION,ha.RATE_OF_CHANGE_SPEED  FROM ALERT.dbo.HARSH_ALERT_DATA(NOLOCK) ha INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=ha.SYSTEM_ID and lvs.CLIENT_ID=ha.CUSTOMER_ID LEFT OUTER JOIN SELF_DRIVE_TRIP_DETAILS s ON ha.REGISTRATION_NO collate database_default=ASSET_NUMBER collate database_default AND ha.GMT BETWEEN s.ACTUAL_TRIP_START_TIME_GMT  AND s.ACTUAL_TRIP_END_TIME_GMT WHERE ha.SYSTEM_ID = ? AND ha.CUSTOMER_ID = ? AND ha.TYPE_OF_ALERT = ? AND ha.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? #  UNION   "
		+ " SELECT s.TRIP_ID, ha.REGISTRATION_NO,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME,ha.GMT,ha.LOCATION,ha.RATE_OF_CHANGE_SPEED FROM ALERT.dbo.HARSH_ALERT_DATA_HISTORY(NOLOCK) ha INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=ha.REGISTRATION_NO COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=ha.SYSTEM_ID and lvs.CLIENT_ID=ha.CUSTOMER_ID LEFT OUTER JOIN SELF_DRIVE_TRIP_DETAILS s ON ha.REGISTRATION_NO collate database_default=ASSET_NUMBER collate database_default AND ha.GMT BETWEEN s.ACTUAL_TRIP_START_TIME_GMT  AND s.ACTUAL_TRIP_END_TIME_GMT WHERE ha.SYSTEM_ID = ? AND ha.CUSTOMER_ID = ? AND ha.TYPE_OF_ALERT = ? AND ha.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? #"
		+ " ) a order by a.GMT ";

	public static final String GET_DRIVING_PERFORMANCE_COUNT = "SELECT t.RANGE AS  CATEGORY , COUNT(*) AS RECORD_COUNT FROM (SELECT CASE " +
			" WHEN tdd.FINAL_SCORE BETWEEN 9.01 AND 10.00 THEN 'GOOD'    WHEN tdd.FINAL_SCORE BETWEEN 7.01 AND 9.00 THEN 'AVG'  ELSE 'BAD' END AS RANGE " +
			" FROM AMS.dbo.TRIP_DRIVER_DETAILS tdd INNER JOIN SELF_DRIVE_TRIP_DETAILS sdtd on tdd.TRIP_ID = sdtd.TRIP_ID INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " +
		    " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID " +
			" WHERE  tdd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.ACTUAL_TRIP_END_TIME_GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? #) t  GROUP BY t.RANGE";

	public static final String GET_DRIVING_PERFORMANCE_DATA = "SELECT ASSET_NUMBER AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,ISNULL(TRIP_ID,'') AS 'TRIP NO',CUSTOMER_ID AS CUSTOMER,CUSTOMER_SCORE AS 'SCORE(%)' from SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER" + 
			" INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID " +
			" where sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ?  AND sdtd.ACTUAL_TRIP_END_TIME_GMT between DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND sdtd.CUSTOMER_SCORE BETWEEN ? AND ? AND vu.User_id = ? # ";
	
 	public static final String GET_SCORE_CALCULATION_FACTOR = "SELECT VALUE AS VALUE FROM PROPERTY_SETTING WHERE PROPERTY = ? AND SYSTEM_ID= ? AND CLIENT_ID = ?";
 	
	public static final String GET_PERFORMANCE_OPS_COUNT_DELIVERY = " SELECT COUNT(*) AS OPS_COUNT FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " +
			" INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID " +
			" WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.OPS_TYPE_DELIVERY IS NOT NULL  AND sdtd.OPS_TYPE_DELIVERY = 'ON_TIME_DELIVERY' AND vu.User_id = ? # ";

	public static final String GET_PERFORMANCE_OPS_COUNT_PICKUP = " SELECT COUNT(*) AS OPS_COUNT FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " +
			" INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID " +
			" WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND  sdtd.INSERTED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.OPS_TYPE_PICKUP IS NOT NULL  AND sdtd.OPS_TYPE_PICKUP = 'ON_TIME_PICKUP' AND vu.User_id = ? # ";

	public static final String GET_PERFORMANCE_OPS_BY_TYPE = " SELECT ASSET_NUMBER,TRIP_ID,# FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER WHERE OPS_TYPE IS NOT NULL AND OPS_TYPE_* = ? AND "
			+ " SYSTEM_ID = ? AND CLIENT_ID = ? AND INSERTED_TIME_GMT BETWEEN  DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id = ? ";

	public static final String GET_VEHICLE_HEALTH_BATTERY_COUNT = "SELECT COUNT(DISTINCT a.REGISTRATION_NO) AS RECORD_COUNT,a.TOGGLE AS CATEGORY FROM AMS.dbo.Alert a " +
			" INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID " +
			" WHERE  a.TYPE_OF_ALERT  = ? AND a.SYSTEM_ID = ? AND a.CLIENTID = ?  AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  vu.User_id=? # AND a.TOGGLE IS NOT NULL GROUP BY a.TOGGLE " +
			" UNION SELECT COUNT(DISTINCT a.REGISTRATION_NO) AS RECORD_COUNT,a.TOGGLE AS CATEGORY FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO " +
			" INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID " +
			" WHERE  a.TYPE_OF_ALERT  = ? AND a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  vu.User_id=? # AND a.TOGGLE IS NOT NULL GROUP BY a.TOGGLE";
	
	public static final String GET_VEHICLE_HEALTH_BATTERY = " SELECT  A.REGISTRATION_NO AS 'VEHICLE NUMBER' ,A.GROUP_NAME AS 'GROUP NAME' , A.VOLTAGE,A.START_DATETIME AS 'START TIME',ISNULL(A.UPDATED_DATETIME,'') AS  'END TIME' FROM  (SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , ISNULL(a.REMARKS,0.00) AS VOLTAGE,a.START_DATETIME,ISNULL(a.UPDATED_DATETIME,'') AS UPDATED_DATETIME FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO " 
			+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID "   
			+ " WHERE  a.SYSTEM_ID = ? AND a.CLIENTID = ?   AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT =  ? AND a.TOGGLE = ? AND vu.User_id = ? # AND a.TOGGLE IS NOT NULL  UNION ALL SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , ISNULL(a.REMARKS,0.00) AS VOLTAGE ,a.START_DATETIME,ISNULL(a.UPDATED_DATETIME,'') AS UPDATED_DATETIME FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO " 
			+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID "
			+ " WHERE  a.SYSTEM_ID = ? AND a.CLIENTID = ?  AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT =  ? AND a.TOGGLE = ? AND vu.User_id = ? # AND a.TOGGLE IS NOT NULL ) A ORDER BY A.START_DATETIME ";

	public static final String GET_VEHICLE_HEALTH_ENGINE_COUNT = "SELECT COUNT(a.TOGGLE) AS HUB_ID_COUNT,a.TOGGLE FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT IN (159,169,166,123,230) AND a.TOGGLE IS NOT NULL AND v.User_id=?  # GROUP BY a.TOGGLE  UNION  "+
	"SELECT COUNT(a.TOGGLE) AS HUB_ID_COUNT,a.TOGGLE FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT IN (159,169,166,123,230) AND a.TOGGLE IS NOT NULL AND v.User_id=? # GROUP BY a.TOGGLE";

public static final String GET_VEHICLE_HEALTH_ENGINE = "SELECT A.REGISTRATION_NO AS 'VEHICLE NO',A.GROUP_NAME AS 'GROUP NAME' , A.AlertName AS 'ALERT TYPE',DATEADD(mi,?,A.GMT) AS LOCALTIME,A.REMARKS FROM ( SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , amd.AlertName ,a.GMT , a.REMARKS  FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TOGGLE = ? AND a.TYPE_OF_ALERT IN (159,169,166,123,230) AND v.User_id=?   #  UNION    " +
		"  SELECT a.REGISTRATION_NO , ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , amd.AlertName ,a.GMT , a.REMARKS FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TOGGLE = ? AND a.TYPE_OF_ALERT IN (159,169,166,123,230) AND v.User_id=? # ) A ORDER BY A.GMT  ";

public static final String GET_VEHICLE_HEALTH_ENGINE_CRITICAL_COUNT = "SELECT COUNT(a.TYPE_OF_ALERT) AS Count FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 174 AND a.REMARKS like 'P%' AND  v.User_id=? # UNION  "+
		" SELECT COUNT(a.TYPE_OF_ALERT) AS Count FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 174 AND a.REMARKS like 'P%' AND  v.User_id=? # ";

public static final String GET_VEHICLE_HEALTH_ENGINE_CRITICAL = "SELECT a.REGISTRATION_NO AS 'VEHICLE NO',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' , amd.AlertName AS 'ALERT TYPE',DATEADD(mi,?,a.GMT) AS LOCALTIME,a.REMARKS FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 174 AND a.REMARKS like 'P%' AND  v.User_id=? #  UNION   " +
		" SELECT a.REGISTRATION_NO AS 'VEHICLE NO',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' , amd.AlertName AS 'ALERT TYPE',DATEADD(mi,?,a.GMT) AS LOCALTIME,a.REMARKS FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 174 AND a.REMARKS like 'P%' AND  v.User_id=? #";

public static final String GET_HEALTH_OPS_COUNT = "SELECT COUNT(a.TYPE_OF_ALERT) AS Count,a.TYPE_OF_ALERT AS AlertType FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT IN (174,160) AND  v.User_id=? # GROUP BY a.TYPE_OF_ALERT  UNION  "+
		" SELECT COUNT(a.TYPE_OF_ALERT) AS Count,a.TYPE_OF_ALERT AS AlertType FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT IN (174,160) AND  v.User_id=?  # GROUP BY a.TYPE_OF_ALERT";

public static final String GET_HEALTH_OPS = "SELECT A.REGISTRATION_NO AS 'VEHICLE NO', A.GROUP_NAME AS 'GROUP NAME' , A.AlertName AS 'ALERT TYPE',DATEADD(mi,?,A.GMT) AS LOCALTIME , A.REMARKS FROM (SELECT  a.REGISTRATION_NO , ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , amd.AlertName , a.GMT , a.REMARKS FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId AND  a.SYSTEM_ID = amd.SystemId  INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID   INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=? AND a.GMT BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND a.TYPE_OF_ALERT =  ? AND  v.User_id=?  #  UNION     " +
		" SELECT a.REGISTRATION_NO , ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , amd.AlertName , a.GMT , a.REMARKS FROM AMS.dbo.Alert_History a  INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId AND  a.SYSTEM_ID = amd.SystemId  INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.SYSTEM_ID =? AND a.CLIENTID=?  AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = ? AND  v.User_id=? # ) A order by A.GMT";

public static final String GET_ACCIDENT_COUNT = "SELECT COUNT(*) AS ACCIDENT_COUNT FROM (SELECT DISTINCT a.REGISTRATION_NO,a.GMT,a.SPEED,a.LOCATION from AMS.dbo.Alert a (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE  a.TYPE_OF_ALERT  = ? AND a.SYSTEM_ID = ? AND a.CLIENTID = ?  "
	+ " AND GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? #  UNION  SELECT DISTINCT ah.REGISTRATION_NO,ah.GMT,ah.SPEED,ah.LOCATION from AMS.dbo.Alert_History ah (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ah.REGISTRATION_NO  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=ah.REGISTRATION_NO AND lvs.SYSTEM_ID=ah.SYSTEM_ID and lvs.CLIENT_ID=ah.CLIENTID  WHERE  ah.TYPE_OF_ALERT  = ? AND ah.SYSTEM_ID = ? AND ah.CLIENTID = ?  "
	+ " AND ah.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND vu.User_id = ? #) AA ";

public static final String GET_ACCIDENT_DATA =  " SELECT  A.REGISTRATION_NO AS 'VEHICLE NO' , A.GROUP_NAME AS 'GROUP NAME' ,DATEADD(MI,?,A.GMT ) AS 'ACCIDENT TIME' , A.LOCATION ,A.SPEED FROM  (SELECT DISTINCT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME, a.GMT ,a.LOCATION,a.SPEED FROM AMS.dbo.Alert a (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE  a.SYSTEM_ID = ? AND a.CLIENTID = ?  "
+ " AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT =  ? AND vu.User_id = ?  #  UNION  SELECT DISTINCT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME, a.GMT ,a.LOCATION,a.SPEED FROM AMS.dbo.Alert_History  a (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE  a.SYSTEM_ID = ? AND a.CLIENTID = ?  "
+ " AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT =  ? AND vu.User_id = ? # ) A  ORDER BY A.GMT ";

public static final String GET_PERFORMANCE_OPS_PICKUP = " SELECT ASSET_NUMBER AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,TRIP_ID AS 'TRIP NO',DATEADD(MI,? ,TRIP_END_TIME_GMT) AS 'PLANNED TRIP END TIME' ,DATEADD(MI,? ,ACTUAL_TRIP_END_TIME_GMT) AS 'QIK OTP TIME', DATEADD(MI,? ,VEHICLE_PICK_UP_TIME) AS 'GEOFENCE TIME'," 
	+ " DATEDIFF (MI,VEHICLE_PICK_UP_TIME,TRIP_END_TIME_GMT) AS 'DIFF(HH:MM)'" 
	+ " FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " 
    + " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  "
	+ " WHERE OPS_TYPE_PICKUP IS NOT NULL AND OPS_TYPE_PICKUP = ? AND  sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT BETWEEN  DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?)  AND vu.User_id = ? # ORDER BY sdtd.INSERTED_TIME_GMT";

public static final String PREVENTIVE_EXPIRED_FROM_PREVENTIVE_EVENTS = " select (select count(ASSET_NUMBER) from FMS.dbo.PREVENTIVE_EVENTS a inner join AMS.dbo.Vehicle_User c on "
	+ " c.Registration_no=a.ASSET_NUMBER collate database_default and c.System_id=a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO  = a.ASSET_NUMBER COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CUSTOMER_ID  where System_Id=? and "
	+ " CUSTOMER_ID =? AND ALERT_TYPE = 1 and c.User_id=? # and EVENT_DATE BETWEEN   (select convert(varchar(10),DATEADD (DAY,-90,convert(varchar(10), getdate(), 120)),120))   and (select convert(varchar(10), getdate(), 120))) "
	+ " - (select count(ASSET_NUMBER) from FMS.dbo.PREVENTIVE_EVENTS a inner join AMS.dbo.Vehicle_User c on c.Registration_no=a.ASSET_NUMBER " 
	+ " collate database_default and c.System_id=a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CUSTOMER_ID   where System_Id=? and datediff(dd,getDate(),POSTPONE_DATE)>= 0 "   
	+ " and CUSTOMER_ID = ? AND ALERT_TYPE = 1 and c.User_id=? # AND  EVENT_DATE BETWEEN    (select convert(varchar(10),DATEADD (DAY,-90,convert(varchar(10), getdate(), 120)),120))   and (select convert(varchar(10), getdate(), 120))) "
	+ " PREVENTIVE_EXPIRED ";


public static final String GET_STATUTORY_ALERT_COUNT_NEW = " select ISNULL (SUM(CASE WHEN AlertId=32 THEN 1 ELSE 0 END),0)AS INSURANCE_EXP, " +
		" ISNULL (SUM(CASE WHEN (AlertId=33 or AlertId=128) THEN 1 ELSE 0 END),0)AS GOODS_TOKEN_TAX_EXP, " +
		" ISNULL ( SUM(CASE WHEN AlertId=34 THEN 1 ELSE 0 END),0)AS FCI_EXP, ISNULL ( SUM(CASE WHEN AlertId=35 THEN 1 ELSE 0 END),0)AS EMISSION_EXP, " +
		" ISNULL ( SUM(CASE WHEN AlertId=36 THEN 1 ELSE 0 END),0)AS PERMIT_EXP,  ISNULL ( SUM(CASE WHEN AlertId=131 THEN 1 ELSE 0 END),0)AS REGISTRATION_EXP, " +
		" ISNULL (SUM(CASE WHEN AlertId=67 THEN 1 ELSE 0 END),0)AS DRIVER_LICENSE_EXP  from  ( select * from dbo.StatutoryAlert where UpdatedDate BETWEEN    " +
		" DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) and  ClientId=? and SystemId=? and AlertId  in (66,67) union select * from dbo.StatutoryAlert where UpdatedDate BETWEEN  " +
		" DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) and  ClientId=? and SystemId=?  and AlertId not in (66,67) and " +
		" VehicleNo in ( select Registration_no from  AMS.dbo.Vehicle_User  where System_id = ? and User_id = ? ) ) s ";

public static final String GET_SERVICE_REMINDERS =  "select  ISNULL(VehicleNo,'') AS 'VEHICLE NO' , DATEADD(MI,?,AlertStartDate ) AS 'EVENT DATE',AlertName AS 'ALERT NAME' from  ( select a.VehicleNo,a.AlertStartDate,b.AlertName from dbo.StatutoryAlert a join dbo.Alert_Master_Details b WITH(NOLOCK)  on a.AlertId = b.AlertId and a.SystemId=b.SystemId where UpdatedDate BETWEEN    " +
		" DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) and  a.ClientId=? and a.SystemId=? and a.AlertId  in (66,67) union select  a.VehicleNo,a.AlertStartDate,b.AlertName from dbo.StatutoryAlert a  join dbo.Alert_Master_Details b WITH(NOLOCK)  on a.AlertId=b.AlertId and a.SystemId=b.SystemId  where UpdatedDate BETWEEN  " +
		" DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) and  a.ClientId=? and a.SystemId=?  and a.AlertId in (33,128,34,36,67) and " +
		" VehicleNo in ( select Registration_no from  AMS.dbo.Vehicle_User  where System_id = ? and User_id = ? ) ) s";
	
	public static final String GET_PERFORMANCE_OPS_DELIVERY = " SELECT ASSET_NUMBER AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,TRIP_ID AS 'TRIP NO' ,DATEADD(MI,? ,TRIP_START_TIME_GMT) AS 'PLANNED TRIP START TIME', DATEADD(MI,? ,ACTUAL_TRIP_START_TIME_GMT) AS 'QIK OTP TIME', DATEADD(MI,? ,VEHICLE_DELIVERY_TIME ) AS 'GEOFENCE TIME' , " +
			" DATEDIFF (MI,VEHICLE_DELIVERY_TIME,TRIP_START_TIME_GMT) AS 'DIFF(HH:MM)' FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER  " +
			" INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  " +
			" WHERE sdtd.OPS_TYPE_DELIVERY IS NOT NULL AND sdtd.OPS_TYPE_DELIVERY = ? AND " +
			" sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT BETWEEN  DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id = ? # ORDER BY VEHICLE_DELIVERY_TIME";
	
	public static final String  GET_ALREADY_EXPIRED_DETAILS_REPORT=" select isnull(a.ASSET_NUMBER,'') as 'VEHICLE NO',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' , isnull(a.EVENT_DATE,'') as 'EVENT DATE','Preventive Expired ' as 'ALERT NAME' "
		+ " from FMS.dbo.PREVENTIVE_EVENTS a "
		+ " inner join AMS.dbo.Vehicle_User c on c.Registration_no=a.ASSET_NUMBER collate database_default and c.System_id=a.SYSTEM_ID"
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER COLLATE DATABASE_DEFAULT AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CUSTOMER_ID " 
		+ " where a.SYSTEM_ID =? and a.CUSTOMER_ID=? and a.ALERT_TYPE =? and c.User_id=? # AND a.EVENT_DATE BETWEEN  (select convert(varchar(10),DATEADD (DAY,-90,convert(varchar(10), getdate(), 120)),120))   and (select convert(varchar(10), getdate(), 120)) order by a.ASSET_NUMBER ";

	public static final String GET_TRIP_STATUS_COUNT_SOURCE = " SELECT COUNT(*) AS SOURCE_COUNT,OPS_TYPE_DELIVERY FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " 
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  " 
		+ " WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND  sdtd.INSERTED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.OPS_TYPE_DELIVERY IS NOT NULL AND vu.User_id = ? # GROUP BY sdtd.OPS_TYPE_DELIVERY ";

	public static final String GET_TRIP_STATUS_COUNT_DESTINATION = " SELECT COUNT(*) AS DESTINATION_COUNT,OPS_TYPE_PICKUP FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " 
	    + " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  " 
		+ " WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.OPS_TYPE_PICKUP IS NOT NULL  AND vu.User_id = ? # GROUP BY sdtd.OPS_TYPE_PICKUP ";

	public static final String GET_KMS_INFORMATION_COUNT = "SELECT COUNT(sdtd.TRAVELLED_KMS) AS EXTRA_KMS FROM dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User vu ON vu.Registration_no = sdtd.ASSET_NUMBER  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID   WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.FREE_KMS IS NOT NULL AND sdtd.FREE_KMS !=-1 AND sdtd.TRAVELLED_KMS IS NOT NULL AND sdtd.TRAVELLED_KMS > sdtd.FREE_KMS AND sdtd.ACTUAL_TRIP_END_TIME_GMT BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id = ? #";
	
	public static final String GET_KMS_INFORMATION_DATA = "SELECT sdtd.ASSET_NUMBER AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' , sdtd.CUSTOMER_ID AS 'CUSTOMER',sdtd.TRIP_ID AS 'TRIP NO',sdtd.FREE_KMS AS 'FREE KMS',sdtd.TRAVELLED_KMS AS 'TRAVELLED KMS',(sdtd.TRAVELLED_KMS-sdtd.FREE_KMS) AS 'EXTRA KMS' FROM dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User vu ON vu.Registration_no = sdtd.ASSET_NUMBER   INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID   WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.FREE_KMS IS NOT NULL AND sdtd.FREE_KMS !=-1 AND sdtd.TRAVELLED_KMS IS NOT NULL AND sdtd.TRAVELLED_KMS > sdtd.FREE_KMS AND sdtd.ACTUAL_TRIP_END_TIME_GMT BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id = ? # ";
	
	public static final String GET_CROSS_BORDER_COUNT = "SELECT COUNT(a.TYPE_OF_ALERT) AS COUNT from AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=84 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=?  #  UNION  "
		+ "SELECT COUNT(a.TYPE_OF_ALERT) AS COUNT from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=84 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # ";
	
	public static final String GET_CROSS_BORDER_DATA = "SELECT A.REGISTRATION_NO AS 'VEHICLE NUMBER',A.GROUP_NAME AS 'GROUP NAME' ,A.AlertName AS 'ALERT TYPE',DATEADD(MI,?,A.GMT ) AS 'LOCALTIME',A.NAME AS 'CROSSED BORDER' from (SELECT  a.REGISTRATION_NO,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME ,amd.AlertName , a.GMT, lz.NAME from AMS.dbo.Alert a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE lz ON lz.HUBID = a.HUB_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=84 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND v.User_id=? # UNION  "
		+ " SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME ,amd.AlertName , a.GMT, lz.NAME from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Alert_Master_Details amd on a.TYPE_OF_ALERT = amd.AlertId INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE lz ON lz.HUBID = a.HUB_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID  WHERE a.TYPE_OF_ALERT=84 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND v.User_id=? # ) A ORDER BY A.GMT";	
		
	public static final String GET_PICKUP_RISK_COUNT = " SELECT COUNT(*) AS PICKUP_RISK_COUNT FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER  "
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  " 
		+ " WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND  sdtd.DESTINATION_ETA_UPDATED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.DESTINATION_ETA_GMT IS NOT NULL AND vu.User_id = ? # AND sdtd.STATUS = 'OPEN' AND DATEDIFF(HH,TRIP_END_TIME_GMT,DESTINATION_ETA_GMT) <=24 ";
	
	public static final String GET_PICKUP_RISK_DATA = " SELECT ASSET_NUMBER AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,TRIP_ID AS 'TRIP NO',DATEADD(MI,?,ACTUAL_TRIP_START_TIME_GMT) AS 'ACTUAL TRIP START TIME',DATEADD(MI,?,TRIP_END_TIME_GMT) AS 'PLANNED TRIP END TIME' ,DATEADD(MI,?,DESTINATION_ETA_GMT) AS ETA, DATEDIFF (MI,TRIP_END_TIME_GMT,DESTINATION_ETA_GMT) AS 'DELAY(HH:MM)' FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER " 
		+ " INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  " 
		+ " WHERE sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND  sdtd.DESTINATION_ETA_UPDATED_TIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND sdtd.DESTINATION_ETA_GMT IS NOT NULL AND vu.User_id = ? # AND sdtd.STATUS = 'OPEN' AND DATEDIFF(HH,TRIP_END_TIME_GMT,DESTINATION_ETA_GMT) <=24 ";

	public static final String GET_RESTRICTIVE_ZONES_COUNT = " SELECT COUNT(*) AS RESTRICTIVE_ZONES_COUNT FROM AMS.dbo.RESTRICTIVE_ZONE_TRANSACTION rz INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = rz.REGISTRATION_NO    INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=rz.REGISTRATION_NO AND lvs.SYSTEM_ID=rz.SYSTEM_ID and lvs.CLIENT_ID=rz.CUSTOMER_ID " 
		+ " WHERE rz.SYSTEM_ID = ? AND rz.CUSTOMER_ID = ? AND  rz.INSERTED_DATETIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?) AND vu.User_id = ? # ";
	
	public static final String GET_RESTRICTIVE_ZONES_DATA = " SELECT rz.REGISTRATION_NO AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,rz.TRIP_NO AS 'TRIP NO',lz.NAME, rz.LOCATION ,DATEADD(MI,?,rz.INSERTED_DATETIME_GMT) AS 'ALERT TIME' FROM AMS.dbo.RESTRICTIVE_ZONE_TRANSACTION rz INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = rz.REGISTRATION_NO   INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=rz.REGISTRATION_NO AND lvs.SYSTEM_ID=rz.SYSTEM_ID and lvs.CLIENT_ID=rz.CUSTOMER_ID  " 
			+ " INNER JOIN AMS.dbo.LOCATION_ZONE_X lz on lz.HUBID = rz.HUB_ID AND lz.SYSTEMID = rz.SYSTEM_ID AND lz.CLIENTID = rz.CUSTOMER_ID WHERE rz.SYSTEM_ID = ? AND rz.CUSTOMER_ID = ? AND rz.INSERTED_DATETIME_GMT  BETWEEN  DATEADD(MI,-?,?) AND  DATEADD(MI,-?,?)   AND vu.User_id = ? # ";

	public static final String GET_LOW_FUEL_COUNT = "SELECT COUNT (DISTINCT(A.REGISTRATION_NO)) AS COUNT FROM (SELECT DISTINCT(a.REGISTRATION_NO) from AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NOT NULL GROUP BY a.REGISTRATION_NO   UNION   "
		+ "SELECT DISTINCT(a.REGISTRATION_NO) from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? #  AND a.UPDATED_DATETIME IS NOT NULL GROUP BY a.REGISTRATION_NO) A";
	
	public static final String GET_LOW_FUEL_DATA = "SELECT A.REGISTRATION_NO AS 'VEHICLE NUMBER',A.GROUP_NAME AS 'GROUP NAME', A.REMARKS  AS 'FUEL LEVEL (Ltr)',DATEADD(MI,?, A.START_DATETIME) AS 'START TIME', DATEADD(MI,?,A.UPDATED_DATETIME) AS 'END TIME'  FROM (SELECT  a.REGISTRATION_NO , ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , a.REMARKS , a.START_DATETIME , a.UPDATED_DATETIME  FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? #  AND a.UPDATED_DATETIME IS NOT NULL    UNION   "
		+ " SELECT  a.REGISTRATION_NO , ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME , a.REMARKS , a.START_DATETIME , a.UPDATED_DATETIME from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NOT NULL ) A ORDER BY A.START_DATETIME";

	public static final String GET_NEAR_FUEL_STATION_COUNT = "SELECT COUNT(a.TYPE_OF_ALERT) AS COUNT from AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NULL    UNION   "
		+ "SELECT COUNT(a.TYPE_OF_ALERT) AS COUNT from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NULL ";
	
	public static final String GET_NEAR_FUEL_STATION_DATA = "SELECT A.REGISTRATION_NO AS 'VEHICLE NUMBER',A.GROUP_NAME AS 'GROUP NAME' , A.REMARKS  AS 'FUEL LEVEL (Ltr)', DATEADD(MI,?, A.START_DATETIME) AS 'START TIME' , NEAR_BY_FUEL_STATIONS AS 'NEAR BY FUEL STATIONS' from (SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME, a.REMARKS , a.START_DATETIME ,(CONVERT(VARCHAR(50),gps.LATITUDE) +',' + CONVERT(VARCHAR(50),gps.LONGITUDE)) AS NEAR_BY_FUEL_STATIONS  FROM  AMS.dbo.Alert a INNER JOIN AMS.dbo.Alert_Master_Details amd ON amd.AlertId = a.TYPE_OF_ALERT AND amd.SystemId = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.gpsdata_history_latest gps on a.REGISTRATION_NO = gps.REGISTRATION_NO  WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NULL    UNION   "
		+ " SELECT a.REGISTRATION_NO ,ISNULL (lvs.GROUP_NAME ,'NA') AS GROUP_NAME, a.REMARKS , a.START_DATETIME,(CONVERT(VARCHAR(50),gps.LATITUDE) +',' + CONVERT(VARCHAR(50),gps.LONGITUDE)) AS NEAR_BY_FUEL_STATIONS  from AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Alert_Master_Details amd ON amd.AlertId = a.TYPE_OF_ALERT AND amd.SystemId = a.SYSTEM_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID INNER JOIN AMS.dbo.gpsdata_history_latest gps on a.REGISTRATION_NO = gps.REGISTRATION_NO WHERE a.TYPE_OF_ALERT=193 AND a.SYSTEM_ID=? AND a.CLIENTID=? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND  v.User_id=? # AND a.UPDATED_DATETIME IS NULL ) A ORDER BY A.START_DATETIME ";
	
	public static final String GET_TOTAL_VEHICLES_COUNT = "SELECT COUNT(ghl.REGISTRATION_NO) AS 'COUNT' FROM gpsdata_history_latest ghl INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = ghl.REGISTRATION_NO AND v.System_id  = ghl.System_id INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=ghl.REGISTRATION_NO AND lvs.SYSTEM_ID=ghl.System_id AND lvs.CLIENT_ID=ghl.CLIENTID WHERE ghl.System_id = ? AND CLIENTID = ? AND v.User_id = ?";
	
	public static final String GET_TOTAL_VEHICLES_DATA = "SELECT ghl.REGISTRATION_NO AS 'VEHICLE NUMBER',lvs.GROUP_NAME AS 'GROUP NAME', DATEADD(MI,?, ghl.GMT) AS 'LAST COMMUNICATED TIME'  FROM AMS.[dbo].gpsdata_history_latest ghl (NOLOCK)  INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = ghl.REGISTRATION_NO AND v.System_id  = ghl.System_id INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=ghl.REGISTRATION_NO AND lvs.SYSTEM_ID=ghl.System_id AND lvs.CLIENT_ID=ghl.CLIENTID WHERE ghl.System_id = ? AND CLIENTID = ? AND v.User_id = ?";
	
	public static final String GET_ON_TRIP_VEHICLES_COUNT = "SELECT COUNT(sdtd.STATUS) AS COUNT FROM SELF_DRIVE_TRIP_DETAILS sdtd (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID AND lvs.CLIENT_ID=sdtd.CLIENT_ID WHERE sdtd.STATUS IS NOT NULL AND sdtd.STATUS = 'OPEN' AND sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND vu.User_id = ?";
	
	public static final String GET_ON_TRIP_VEHICLES_DATA = "SELECT sdtd.ASSET_NUMBER AS 'VEHICLE NUMBER',lvs.GROUP_NAME AS 'GROUP NAME', DATEADD(MI,?, sdtd.ACTUAL_TRIP_START_TIME_GMT) AS 'TRIP START TIME' FROM SELF_DRIVE_TRIP_DETAILS sdtd (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID AND lvs.CLIENT_ID=sdtd.CLIENT_ID WHERE sdtd.STATUS IS NOT NULL AND sdtd.STATUS = 'OPEN' AND sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND vu.User_id = ?";
	
	public static final String GET_ON_ROAD_VEHICLES_COUNT = "SELECT COUNT(ghl.REGISTRATION_NO) AS COUNT FROM AMS.[dbo].gpsdata_history_latest ghl (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ghl.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=ghl.REGISTRATION_NO AND lvs.SYSTEM_ID=ghl.System_id AND lvs.CLIENT_ID=ghl.CLIENTID WHERE ghl.System_id = ? AND ghl.CLIENTID = ? AND ghl.CATEGORY IS NOT NULL AND (ghl.CATEGORY = 'idle' OR ghl.CATEGORY = 'running') AND vu.User_id=? AND ghl.REGISTRATION_NO NOT IN (SELECT ASSET_NUMBER FROM [dbo].[SELF_DRIVE_TRIP_DETAILS] WHERE STATUS='OPEN')";

	public static final String GET_ON_ROAD_VEHICLES_DATA = "SELECT ghl.REGISTRATION_NO AS 'VEHICLE NUMBER',lvs.GROUP_NAME AS 'GROUP NAME', DATEADD(MI,?, ghl.GMT) AS 'LAST COMMUNICATED TIME' FROM AMS.[dbo].gpsdata_history_latest ghl (NOLOCK) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = ghl.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=ghl.REGISTRATION_NO AND lvs.SYSTEM_ID=ghl.System_id AND lvs.CLIENT_ID=ghl.CLIENTID WHERE ghl.System_id = ? AND ghl.CLIENTID = ? AND ghl.CATEGORY IS NOT NULL AND (ghl.CATEGORY = 'idle' OR ghl.CATEGORY = 'running')  AND vu.User_id=? AND ghl.REGISTRATION_NO NOT IN (SELECT ASSET_NUMBER FROM [dbo].[SELF_DRIVE_TRIP_DETAILS] WHERE STATUS='OPEN')";
	
	public static final String GET_VEHICLES_AT_SERVICE_STATION_COUNT = "SELECT COUNT(hr.REGISTRATION_NO) AS COUNT FROM AMS.dbo.HUB_REPORT hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID =  18  AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?   UNION   "
		+" SELECT COUNT(hr.REGISTRATION_NO) AS COUNT FROM AMS.dbo.HUB_REPORT_HISTORY hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID =  18 AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=? ";

	public static final String GET_VEHICLES_AT_SERVICE_STATION_DATA = "SELECT hr.REGISTRATION_NO AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD(MI,?, hr.ACTUAL_ARRIVAL) AS 'SERVICE STATION ARRIVAL TIME'  FROM AMS.dbo.HUB_REPORT hr (nolock) INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID =  18  AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?   UNION   "
		+" SELECT hr.REGISTRATION_NO AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD(MI,?, hr.ACTUAL_ARRIVAL) AS 'SERVICE STATION ARRIVAL TIME'  FROM AMS.dbo.HUB_REPORT_HISTORY hr (nolock) INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID =  18 AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?";
	
	public static final String GET_VEHICLES_AT_HUB_LOCATIONS_COUNT = "SELECT COUNT(hr.REGISTRATION_NO) AS COUNT FROM AMS.dbo.HUB_REPORT hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID !=  18  AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?   UNION   "
		+" SELECT COUNT(hr.REGISTRATION_NO) AS COUNT FROM AMS.dbo.HUB_REPORT_HISTORY hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID !=  18 AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=? ";
	
	public static final String GET_VEHICLES_AT_HUB_LOCATIONS_DATA = "SELECT hr.REGISTRATION_NO AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD(MI,?, hr.ACTUAL_ARRIVAL) AS 'HUB LOCATION ARRIVAL TIME'  FROM AMS.dbo.HUB_REPORT hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID !=  18  AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?   UNION   "
		+" SELECT hr.REGISTRATION_NO AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD(MI,?, hr.ACTUAL_ARRIVAL) AS 'HUB LOCATION ARRIVAL TIME'  FROM AMS.dbo.HUB_REPORT_HISTORY hr (nolock) INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hr.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=hr.REGISTRATION_NO AND lvs.SYSTEM_ID=hr.SYSTEM_ID INNER JOIN AMS.dbo.LOCATION_ZONE_A lz ON lz.HUBID = hr.HUB_ID AND lz.SYSTEMID = hr.SYSTEM_ID WHERE hr.SYSTEM_ID = ? AND lz.OPERATION_ID !=  18 AND lz.CLIENTID = ? AND hr.ACTUAL_DEPARTURE IS NULL AND hr.ACTUAL_ARRIVAL BETWEEN DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id=?";
	
	public static final String GET_VEHICLES_CURRENT_POSITION = " SELECT REGISTRATION_NO,LATITUDE,LONGITUDE,LOCATION FROM AMS.dbo.gpsdata_history_latest WHERE  System_id = ? AND CLIENTID = ? AND ## ";
	
	public static final String GET_TODAY_TRAVELLED_KMS = "SELECT (MAX(ODOMETER)-MIN(ODOMETER)) AS COUNT FROM HISTORY_DATA_## (NOLOCK) a INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = a.REGISTRATION_NO WHERE a.GMT BETWEEN DATEADD(MI,-?,?) AND DATEADD(MI,-?,?) AND vu.User_id=? GROUP BY a.REGISTRATION_NO";
	
	public static final String GET_TODAY_TRAVELLED_KMS_DATA = "SELECT hd.REGISTRATION_NO AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME', (MAX(hd.ODOMETER)-MIN(hd.ODOMETER)) AS 'TRAVELLED KMS' FROM HISTORY_DATA_## (NOLOCK) hd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = hd.REGISTRATION_NO INNER JOIN AMS.dbo.Live_Vision_Support lvs ON lvs.REGISTRATION_NO=hd.REGISTRATION_NO WHERE hd.GMT BETWEEN DATEADD(MI,-?,?) AND DATEADD(MI,-?,?) AND vu.User_id=? GROUP BY hd.REGISTRATION_NO,lvs.GROUP_NAME ORDER BY 'TRAVELLED KMS' DESC";
	
	public static final String GET_GROUP_NAMES = "SELECT DISTINCT(GROUP_NAME) FROM AMS.dbo.Live_Vision_Support WHERE SYSTEM_ID= ? and CLIENT_ID = ?";
	
	public static final String PERFORMANCE_OPS_DELAY_START ="SELECT ASSET_NUMBER AS 'VEHICLE NUMBER',ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,TRIP_ID AS 'TRIP NO' ,DATEADD(MI,? ,TRIP_START_TIME_GMT) AS 'PLANNED TIME',DATEADD(MI,? ,ACTUAL_TRIP_START_TIME_GMT) AS 'ACTUAL TIME', DATEADD(MI,? ,VEHICLE_DELIVERY_TIME ) AS 'DELIVERY/PICKUP TIME' , DATEDIFF (MI,VEHICLE_DELIVERY_TIME,TRIP_START_TIME_GMT) AS 'DIFF(HH:MM)','DELAY START' AS 'DELAY START/REACH' " +
			" FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID WHERE sdtd.OPS_TYPE_DELIVERY IS NOT NULL AND sdtd.OPS_TYPE_DELIVERY = ? AND " +
			" sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT BETWEEN  DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?) AND vu.User_id = ? # ORDER BY VEHICLE_DELIVERY_TIME";
	
	public static final String PERFORMANCE_OPS_DELAY_REACH ="SELECT ASSET_NUMBER AS 'VEHICLE NUMBER', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME' ,TRIP_ID AS 'TRIP NO',DATEADD(MI,? ,TRIP_END_TIME_GMT)AS 'PLANNED TIME' ,DATEADD(MI,? ,ACTUAL_TRIP_END_TIME_GMT) AS 'ACTUAL TIME', DATEADD(MI,? ,VEHICLE_PICK_UP_TIME) AS 'DELIVERY/PICKUP TIME',DATEDIFF (MI,VEHICLE_PICK_UP_TIME,TRIP_END_TIME_GMT) AS 'DIFF(HH:MM)' , 'DELAY REACH' AS 'DELAY START/REACH'  " +
			" FROM AMS.dbo.SELF_DRIVE_TRIP_DETAILS sdtd INNER JOIN AMS.dbo.Vehicle_User  vu ON vu.Registration_no = sdtd.ASSET_NUMBER  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=sdtd.ASSET_NUMBER AND " +
			" lvs.SYSTEM_ID=sdtd.SYSTEM_ID and lvs.CLIENT_ID=sdtd.CLIENT_ID  WHERE OPS_TYPE_PICKUP IS NOT NULL AND OPS_TYPE_PICKUP = ? AND  sdtd.SYSTEM_ID = ? AND sdtd.CLIENT_ID = ? AND sdtd.INSERTED_TIME_GMT BETWEEN  DATEADD(MI,-?,? )  AND  DATEADD(MI,-?,?)  AND vu.User_id = ? # ORDER BY sdtd.INSERTED_TIME_GMT";
	
	public static final String GET_IDLE_COUNT = "SELECT COUNT(DISTINCT(a.REGISTRATION_NO)) AS COUNT FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 39 AND v.User_id=? #  UNION    "
			+" SELECT COUNT(DISTINCT(a.REGISTRATION_NO)) AS COUNT FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?) AND a.TYPE_OF_ALERT = 39 AND v.User_id=? # ";

	public static final String GET_IDLE_DATA = "SELECT a.REGISTRATION_NO AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD (MI,?,a.GMT) AS 'ALERT TIME' , a.STOP_HOURS AS 'IDLE DURATION(HH.MM)',s.TRIP_ID AS 'TRIP ID' FROM AMS.dbo.Alert a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID LEFT OUTER JOIN SELF_DRIVE_TRIP_DETAILS s ON a.REGISTRATION_NO collate database_default=ASSET_NUMBER AND a.GMT BETWEEN s.ACTUAL_TRIP_START_TIME_GMT  AND s.ACTUAL_TRIP_END_TIME_GMT WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN   DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?)  AND a.TYPE_OF_ALERT = 39 AND v.User_id=?  #  UNION   "
			+" SELECT a.REGISTRATION_NO AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',DATEADD (MI,?,a.GMT) AS 'ALERT TIME' , a.STOP_HOURS AS 'IDLE DURATION',s.TRIP_ID AS 'TRIP ID' FROM AMS.dbo.Alert_History a INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.REGISTRATION_NO AND v.System_id  = a.SYSTEM_ID  INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.REGISTRATION_NO AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENTID LEFT OUTER JOIN SELF_DRIVE_TRIP_DETAILS s ON a.REGISTRATION_NO collate database_default=ASSET_NUMBER AND a.GMT BETWEEN s.ACTUAL_TRIP_START_TIME_GMT  AND s.ACTUAL_TRIP_END_TIME_GMT WHERE a.SYSTEM_ID = ? AND a.CLIENTID = ? AND a.GMT  BETWEEN  DATEADD(mi,-?,?)  AND DATEADD(mi,-?,?)  AND a.TYPE_OF_ALERT = 39 AND v.User_id = ? # ";
	
	public static final String GET_MILEAGE_COUNT = "SELECT COUNT(DISTINCT(a.ASSET_NUMBER)) AS 'COUNT' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ?  $ AND a.MILEAGE BETWEEN 0.1 AND 25 AND v.User_id=? #";
	
	public static final String GET_MILEAGE_DATA = "SELECT a.ASSET_NUMBER AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',a.DATE AS 'DATE', a.MILEAGE AS 'MILEAGE',a.TRIP_ID AS 'TRIP NO' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.MILEAGE BETWEEN 0.1 AND 25 AND v.User_id=? #";
	
	public static final String GET_REFUEL_COUNT = "SELECT COUNT(a.ASSET_NUMBER) AS COUNT FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.REFUEL > 0 AND v.User_id=? #";
	
	public static final String GET_REFUEL_DATA = "SELECT a.ASSET_NUMBER AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',a.DATE AS 'DATE', a.REFUEL AS 'REFUEL (Ltrs)',a.TRIP_ID AS 'TRIP NO' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.REFUEL > 0 AND v.User_id=? # ";
	
	public static final String GET_PILFERAGE_COUNT = "SELECT COUNT(a.ASSET_NUMBER) AS COUNT FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.PILFERAGE > 0 AND v.User_id=? # ";
	
	public static final String GET_PILFERAGE_DATA = "SELECT a.ASSET_NUMBER AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',a.DATE AS 'DATE', a.PILFERAGE AS 'PILFERAGE (Ltrs)',a.TRIP_ID AS 'TRIP NO' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.PILFERAGE > 0 AND v.User_id=? #";
	
	public static final String GET_MAIL_ID = "SELECT Emailed AS 'MAIL' FROM Users WHERE System_id = ? AND Client_id = ? AND User_id = ?";
	
	public static final String GET_MILEAGE_DROP_COUNT = "SELECT COUNT(DISTINCT(a.ASSET_NUMBER)) AS 'COUNT' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ?  $ AND a.MILEAGE BETWEEN 0 AND 5 AND v.User_id=? #";
	
	public static final String GET_MILEAGE_DROP_DATA = "SELECT a.ASSET_NUMBER AS 'VEHICLE NO', ISNULL (lvs.GROUP_NAME ,'NA') AS 'GROUP NAME',a.DATE AS 'DATE', a.MILEAGE AS 'MILEAGE',a.TRIP_ID AS 'TRIP NO' FROM AMS.[dbo].[REFUEL_MILEAGE_SUMMARY] a INNER JOIN AMS.dbo.Live_Vision_Support lvs on lvs.REGISTRATION_NO=a.ASSET_NUMBER AND lvs.SYSTEM_ID=a.SYSTEM_ID and lvs.CLIENT_ID=a.CLIENT_ID INNER JOIN AMS.dbo.Vehicle_User v on v.Registration_no = a.ASSET_NUMBER AND v.System_id  = a.SYSTEM_ID WHERE a.SYSTEM_ID = ? AND a.CLIENT_ID = ? $ AND a.MILEAGE BETWEEN 0 AND 5 AND v.User_id=? #";
}